<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Product Details</title>

<style>

body{
margin:0;
font-family:Arial;
background:#f1f3f6;
}

/* HEADER */

.header{
background:#2874f0;
color:white;
padding:12px;
display:flex;
align-items:center;
justify-content:space-between;
}

.back{
font-size:20px;
cursor:pointer;
}

.cart{
font-size:20px;
}

/* IMAGE */

.image{
background:white;
}

.image img{
width:100%;
}

/* INFO */

.info{
background:white;
margin-top:10px;
padding:15px;
}

.name{
font-size:18px;
margin-bottom:8px;
}

.price{
font-size:22px;
font-weight:bold;
}

.mrp{
text-decoration:line-through;
color:gray;
margin-left:6px;
}

.discount{
color:green;
margin-left:6px;
font-weight:bold;
}

.delivery{
margin-top:10px;
color:#555;
}

/* BUTTONS */

.bottom{
position:fixed;
bottom:0;
left:0;
right:0;
display:flex;
}

.btn{
flex:1;
text-align:center;
padding:14px;
color:white;
font-weight:bold;
}

.cartbtn{
background:#ff9f00;
}

.buybtn{
background:#fb641b;
}

</style>

</head>

<body>

<!-- HEADER -->

<div class="header">

<div class="back" onclick="history.back()">‚Üê</div>

<div>Product Details</div>

<div class="cart">üõí</div>

</div>


<!-- PRODUCT IMAGE -->

<div class="image">

<img id="img">

</div>


<!-- PRODUCT INFO -->

<div class="info">

<div class="name" id="name"></div>

<div>

<span class="price">‚Çπ<span id="price"></span></span>

<span class="mrp">‚Çπ<span id="mrp"></span></span>

<span class="discount" id="discount"></span>

</div>

<div class="delivery" id="delivery"></div>

</div>


<!-- BUTTONS -->

<div class="bottom">

<div class="btn cartbtn">Add to Cart</div>

<div class="btn buybtn" onclick="buyNow()">Buy Now</div>

</div>



<!-- FIREBASE -->

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBfA-mFODccLz13nLpFQFI5Q2qBNIS2_KI",
  authDomain: "flipkart-clone-ab903.firebaseapp.com",
  databaseURL: "https://flipkart-clone-ab903-default-rtdb.firebaseio.com",
  projectId: "flipkart-clone-ab903",
  storageBucket: "flipkart-clone-ab903.firebasestorage.app",
  messagingSenderId: "733319152647",
  appId: "1:733319152647:web:cb5943fc21d8676bad16a2"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);


/* PRODUCT ID */

const params = new URLSearchParams(location.search);
const id = params.get("id");


if(!id){

alert("Product not found");
history.back();

}


/* LOAD PRODUCT */

const snapshot = await get(ref(db,"products/"+id));

if(!snapshot.exists()){

alert("Product missing");
history.back();

}

const p = snapshot.val();


img.src = p.image;
name.innerText = p.name;
price.innerText = p.price;
mrp.innerText = p.mrp;
delivery.innerText = p.delivery;


/* DISCOUNT */

let dis = Math.round((p.mrp - p.price) / p.mrp * 100);

discount.innerText = dis + "% off";


/* BUY */

window.buyNow = function(){

localStorage.setItem("product", JSON.stringify(p));

location.href = "address.html";

}

</script>

</body>
</html>
